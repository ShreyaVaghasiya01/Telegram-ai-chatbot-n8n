{
  "name": "AI chatbot",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {
          "download": true
        }
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -288,
        64
      ],
      "id": "47039fb0-4d96-4477-a32d-f576d571f54d",
      "name": "Telegram Trigger",
      "webhookId": "57020eb4-10c5-43e0-b90f-ec9ae8f895c1",
      "credentials": {
        "telegramApi": {
          "id": "Yo1IyCJOh7TUIQle",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.message.text }}",
        "options": {
          "systemMessage": "=You are a friendly, professional, and intelligent AI assistant designed for a Telegram chatbot.\nYou communicate in the same language the user uses (English, Hindi, Gujarati, or any other language)\nand automatically detect and adapt your tone.\n\nYour personality:\n- Warm, helpful, polite, and slightly humorous  \n- Professional and clear when explaining  \n- Friendly like a smart companion  \n- Never rude, negative, or confusing  \n\nYour abilities:\n1. **Text understanding & conversation**  \n   - Understand context from previous messages (memory).  \n   - Keep replies short, meaningful, and engaging.  \n\n2. **Image understanding**  \n   - If the user sends an image, analyze it and describe it clearly.  \n   - If the image has a caption, treat both:  \n     - Caption = user message  \n     - Image = visual context  \n\n3. **Multilingual support**  \n   - Detect the user’s language instantly.  \n   - Reply naturally in the same language.   \n\n4. **Memory behaviour**  \n   - Remember the conversation inside the session.  \n   - Keep responses consistent and context-aware.  \n\nRules:\n- Never mention system messages or internal configuration.  \n- Never output harmful, illegal, or abusive content.  \n- Always aim to be helpful, friendly, and professional.  \n- For unclear requests, politely ask for clarification.  \n\nYour goal:  \nProvide useful, fast, creative, and enjoyable responses—making the chat feel natural and smart.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        288,
        176
      ],
      "id": "9cd080de-27e0-4a55-8cd6-941e87720e5b",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        192,
        336
      ],
      "id": "c9e2aa15-65f1-4305-9f85-56fc40ecd252",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "ugp6dUaU2odr7uwA",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id  }}",
        "text": "={{ $json.output || $json.choices[0].message.content }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        848,
        48
      ],
      "id": "08fac1c8-01d3-41f3-88c2-53e1378ac03a",
      "name": "Send a text message",
      "webhookId": "cb85337a-cd63-440b-866c-c58826dd7c17",
      "credentials": {
        "telegramApi": {
          "id": "Yo1IyCJOh7TUIQle",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "c02bb101-06b9-46e9-bd53-87a4df0a2430",
              "leftValue": "={{ $json.message.photo }}",
              "rightValue": true,
              "operator": {
                "type": "array",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -80,
        64
      ],
      "id": "d0d4d63b-6648-46d8-b9e2-03161f46f034",
      "name": "If"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.groq.com/openai/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"{{ $('Telegram Trigger').item.json.message.caption }}\"\n        },\n        {\n          \"type\": \"image_url\",\n          \"image_url\": {\n            \"url\": \"{{ $json.telegram_image_url }}\"\n          }\n        }\n      ]\n    }\n  ],\n  \"model\": \"meta-llama/llama-4-scout-17b-16e-instruct\",\n  \"temperature\": 1,\n  \"max_completion_tokens\": 1024,\n  \"top_p\": 1,\n  \"stream\": false,\n  \"stop\": null\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        544,
        -32
      ],
      "id": "0e8ed9b9-51f5-4712-86f5-fff23fe5e88c",
      "name": "HTTP Request",
      "credentials": {
        "httpBearerAuth": {
          "id": "ZY7NPDfwzZ1FflPx",
          "name": "Bearer Auth account 2"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api.telegram.org/bot8532183112:AAGUs2Ch_173O47U_NnyShjsZAHmTbXPI2g/getFile",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "file_id",
              "value": "={{ $json.message.photo[1].file_id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        128,
        -32
      ],
      "id": "ed63b78d-6752-4577-875b-cc7dd97d9c7e",
      "name": "Get Telegram File"
    },
    {
      "parameters": {
        "jsCode": "// Get file_path from previous \"Get Telegram File\" node\nconst filePath = $input.first().json.result.file_path;\n\n// YOUR BOT TOKEN HERE (replace with your actual token)\nconst botToken = \"8532183112:AAGUs2Ch_173O47U_NnyShjsZAHmTbXPI2g\";\n\n// Build the full image URL\nconst telegramFileUrl = `https://api.telegram.org/file/bot${botToken}/${filePath}`;\n\nreturn [{\n  json: {\n    telegram_image_url: telegramFileUrl,\n    chat_id: $('Telegram Trigger').item.json.message.chat.id,\n    caption: $('Telegram Trigger').item.json.message.caption || 'Describe this image.'\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        336,
        -32
      ],
      "id": "85125b55-3b12-4e47-a604-d3b5ba95a473",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $json.message.chat.id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        352,
        368
      ],
      "id": "e52752b8-4dc4-4b4e-830a-10ab2df482c3",
      "name": "Simple Memory"
    }
  ],
  "pinData": {},
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Get Telegram File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Telegram File": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "3d9a95a7-d449-4564-bf91-ed2c284313c3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "f3329f94a5d5156822621e8a1faec5f1b2fee86a8125d8b83c7528edce508c47"
  },
  "id": "mbjICo6Ju5qzlhHd",
  "tags": []
}